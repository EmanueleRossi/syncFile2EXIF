plugins {
  id 'java'
  id 'application'
}

mainClassName = 'org.erossi.syncFile2EXIF.SyncFile2EXIF'

dependencies {
  compile 'com.drewnoakes:metadata-extractor:2.11.0'
  compile 'commons-io:commons-io:2.6'  

  testCompile 'junit:junit:4.12'
}

def getGitShortHash = { ->
  def stdout = new ByteArrayOutputStream()
  exec {
    commandLine 'git', 'rev-parse', '--short', 'HEAD'
    standardOutput = stdout
  }
  return stdout.toString().trim()
}

jar {
  manifest {
    attributes (
      'Main-Class': 'org.erossi.syncFile2EXIF.SyncFile2EXIF',
      'Git-Hash': getGitShortHash()
    )  
  }
  baseName = project.name + '-all'
  from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }  
}

test {
  testLogging.showStandardStreams = true
}

repositories {    
  jcenter()
}
